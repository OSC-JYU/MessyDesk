
What happend when user clicks "Crunch"

1. Request is made to queue endpoint

post('/api/queue/:topic/files/:file_rid'

1.1. Endpoint create a Process node to database.

1.2. Based on RID of process node, a directory is created for node
1.3 Request body is written to a file (params.json)
1.4 UI is updated so that process node is displayd (send2UI)

1.5 IF process has attribute "output_set", then output Set is created
1.6 UI is updated so that set node is displayd (send2UI)

2. Message is published to stream

nats.publish(topic, JSON.stringify(ctx.request.body))



3. Stream consumer app gets the Message

3.1 Consumer app cals processing endpoint
3.1.1 streams file to endpoint with params

3.2 When endpoint responses, the consumer app donwloads files from processing endpoint and send them to MessyDesk 
    post('/api/nomad/process/files')

4. MessyDesk receives files
IF file is thumbnail
    then save file as thubnail file to the node path
ELSE
4.1 A File Node is created and a node path is created
4.2 File is saved in node path
4.3 UI is updated
4.4 send file to thumbnailer queue







